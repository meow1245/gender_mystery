<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>性別議題劇本殺</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>🎭 性別議題劇本殺</h1>

        <!-- 音樂控制按鈕 -->
        <button class="music-control" id="musicToggle" onclick="toggleMusic()">🔊</button>

        <!-- 首頁 -->
        <div id="homeScreen" class="screen active">
            <div class="input-group">
                <label>你的名字</label>
                <input type="text" id="playerName" placeholder="輸入你的名字">
            </div>
            <button onclick="showCreateRoom()" class="full-width">創建房間</button>
            <button onclick="showJoinRoom()" class="full-width">加入房間</button>
        </div>

        <!-- 創建房間 - 選擇類型 -->
        <div id="createRoomScreen" class="screen">
            <h2 style="margin-bottom: 20px;">創建房間 - 選擇劇本類型</h2>
            
            <label>選擇劇本類型</label>
            <div class="script-type-selector">
                <div class="script-card" onclick="selectScriptType('teen')">
                    <h3>📚 未成年劇本</h3>
                    <p style="font-size: 0.9em; color: #666;">校園故事、討論導向<br>重在反思與教育</p>
                    <span class="badge badge-teen">教育性質</span>
                </div>
                <div class="script-card" onclick="selectScriptType('adult')">
                    <h3>🔍 成年劇本</h3>
                    <p style="font-size: 0.9em; color: #666;">推理導向、玩家可能是壞人<br>深度議題探討</p>
                    <span class="badge badge-adult">推理性質</span>
                </div>
            </div>

            <button onclick="backToHome()" class="full-width" style="background: #6c757d;">返回</button>
        </div>

        <!-- 創建房間 - 選擇人數 -->
        <div id="selectPlayerCountScreen" class="screen">
            <h2 style="margin-bottom: 20px;">選擇房間人數</h2>
            
            <div class="room-size-selector">
                <button class="room-size-btn" onclick="selectRoomSize(3)">3人</button>
                <button class="room-size-btn" onclick="selectRoomSize(4)">4人</button>
                <button class="room-size-btn" onclick="selectRoomSize(5)">5人</button>
                <button class="room-size-btn" onclick="selectRoomSize(6)">6人</button>
            </div>

            <button onclick="backToScriptType()" class="full-width" style="background: #6c757d;">返回</button>
        </div>

        <!-- 創建房間 - 選擇劇本 -->
        <div id="selectScriptScreen" class="screen">
            <h2 style="margin-bottom: 20px;">選擇劇本</h2>
            
            <div class="script-list" id="scriptList"></div>

            <button onclick="backToPlayerCount()" class="full-width" style="background: #6c757d;">返回</button>
        </div>

        <!-- 加入房間 -->
        <div id="joinRoomScreen" class="screen">
            <h2 style="margin-bottom: 20px;">加入房間</h2>
            <div class="input-group">
                <label>房間代碼</label>
                <input type="text" id="roomCode" placeholder="輸入6位房間代碼" maxlength="6" style="text-transform: uppercase;">
            </div>
            <button onclick="joinRoom()" class="full-width">加入遊戲</button>
            <button onclick="backToHome()" class="full-width" style="background: #6c757d;">返回</button>
        </div>

        <!-- 等候室 -->
        <div id="lobbyScreen" class="screen">
            <div class="alert alert-info">
                <strong>🎮 房間代碼：<span id="displayRoomCode"></span></strong>
                <p>劇本：<span id="displayScriptName"></span></p>
                <p>人數：<span id="currentPlayers">0</span>/<span id="maxPlayers">0</span> | 預計時長：<span id="displayDuration"></span></p>
            </div>

            <div class="player-list">
                <h3>玩家列表</h3>
                <div id="playersList"></div>
            </div>

            <div id="hostControls" style="display:none;">
                <button onclick="startGame()" class="full-width">開始遊戲</button>
            </div>
            <button onclick="leaveRoom()" class="full-width" style="background: #dc3545;">離開房間</button>
        </div>

        <!-- 遊戲畫面 -->
        <div id="gameScreen" class="screen">
            <div class="day-indicator" id="dayIndicator">第一天</div>
            <div class="phase-info" id="phaseInfo">早晨 - 自由討論時間</div>

            <div class="character-card">
                <img id="characterPortrait" class="character-portrait" src="" alt="角色圖片" style="display:none;">
                <h3>你的角色：<span id="characterName"></span></h3>
                <p><strong>背景：</strong><span id="characterBackground"></span></p>
                <p style="margin-top: 10px;"><strong>你的秘密：</strong><span id="characterSecret"></span></p>
                <p id="characterGoal" style="margin-top: 10px; color: #e74c3c;"></p>
            </div>

            <div class="event-card" id="eventCard" style="display:none;">
                <h4>📢 新事件發生</h4>
                <p id="eventContent"></p>
            </div>

            <div class="discussion-questions" id="discussionQuestions">
                <h4>💭 討論方向</h4>
                <ul id="questionList"></ul>
            </div>

            <div class="timer" id="timer"></div>

            <div class="chat-container" id="chatContainer"></div>

            <div class="input-group">
                <textarea id="messageInput" placeholder="輸入訊息..." rows="2"></textarea>
                <div style="display: flex; gap: 10px; margin-top: 10px;">
                    <select id="messageType" style="flex: 1;">
                        <option value="public">公開發言</option>
                        <option value="private">私密訊息</option>
                    </select>
                    <select id="privateTarget" style="flex: 1; display: none;">
                        <option value="">選擇私聊對象</option>
                    </select>
                </div>
            </div>
            <button onclick="sendMessage()" class="full-width">發送訊息</button>

            <div class="vote-section" id="voteSection" style="display:none;">
                <h3>🗳️ 投票環節</h3>
                <p id="votePrompt"></p>
                <div id="voteButtons"></div>
            </div>

            <div id="gameResult" style="display:none;"></div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module" src="firebase-config.js"></script>
    <script type="module" src="scripts.js"></script>
</body>
</html>